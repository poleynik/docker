# Filebeat collector for project servers
input {
  beats {
    port => 5049
  }
}

filter {
    # Change UpperCase hostnames to lowercase
    mutate {
      lowercase => [ "[host][name]" ]
      lowercase => [ "[host][hostname]" ]
    }
}

output {
  if [host][hostname] in ["docker", "tgrsapp"] {
    elasticsearch {
    index => "%{[@metadata][beat]}-%{[@metadata][version]}-grs-%{+YYYY.MM.dd}"
    hosts => ["http://192.168.1.42:9200", "192.168.118.11:9200"]
    user => 'logstash_writer'
    password => '12345Asd'
    }
  }
  else {
    elasticsearch {
    index => "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"
    hosts => ["http://192.168.1.42:9200", "http://192.168.118.11:9200"]
    user => 'logstash_writer'
    password => '12345Asd'
    }
    #stdout { codec => rubydebug }
  } 
   
}
